(function(e){"use strict";var t=0,n='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',r='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',i='<div class="ui-colorpicker ui-colorpicker-inline"></div>',s=function(e){var t=Math.floor(e).toString(16);if(t.length===1){t="0"+t}return t.toLowerCase()},o=function(t){var n,r;r=/^#?([a-fA-F0-9]{1,6})$/.exec(t);if(r){n=parseInt(r[1],16);return new e.colorpicker.Color((n>>16&255)/255,(n>>8&255)/255,(n&255)/255)}return new e.colorpicker.Color},u=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m;t.sort(function(e,t){if(e.pos[1]===t.pos[1]){return e.pos[0]-t.pos[0]}return e.pos[1]-t.pos[1]});o=0;u=0;e.each(t,function(e,t){o=Math.max(o,t.pos[0]+t.pos[2]);u=Math.max(u,t.pos[1]+t.pos[3])});r=[];for(i=0;i<o;++i){r.push([])}f=[];a=[];e.each(t,function(e,t){for(i=0;i<t.pos[2];i+=1){a[t.pos[0]+i]=true}for(s=0;s<t.pos[3];s+=1){f[t.pos[1]+s]=true}});h="";c=t[l=0];for(s=0;s<u;++s){h+="<tr>";i=0;while(i<o){if(typeof c!=="undefined"&&i===c.pos[0]&&s===c.pos[1]){h+=n(c,i,s);for(d=0;d<c.pos[3];d+=1){for(p=0;p<c.pos[2];p+=1){r[i+p][s+d]=true}}i+=c.pos[2];c=t[++l]}else{v=0;m=false;while(i<o&&r[i][s]===undefined&&(c===undefined||s<c.pos[1]||s===c.pos[1]&&i<c.pos[0])){if(a[i]===true){v+=1}m=true;i+=1}if(v>0){h+='<td colspan="'+v+'"></td>'}else if(!m){i+=1}}}h+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+h+"</tbody></table>"};e.colorpicker=new function(){this.regional={"":{ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}};this.swatches={html:{black:{r:0,g:0,b:0},dimgray:{r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},gray:{r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},darkgray:{r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},silver:{r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},lightgrey:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},gainsboro:{r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},whitesmoke:{r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},indianred:{r:.803921568627451,g:.3607843137254902,b:.3607843137254902},brown:{r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},firebrick:{r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},lightcoral:{r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},maroon:{r:.5019607843137255,g:0,b:0},darkred:{r:.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:.9803921568627451,b:.9803921568627451},salmon:{r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},mistyrose:{r:1,g:.8941176470588236,b:.8823529411764706},tomato:{r:1,g:.38823529411764707,b:.2784313725490196},darksalmon:{r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},orangered:{r:1,g:.27058823529411763,b:0},coral:{r:1,g:.4980392156862745,b:.3137254901960784},lightsalmon:{r:1,g:.6274509803921569,b:.47843137254901963},sienna:{r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},seashell:{r:1,g:.9607843137254902,b:.9333333333333333},chocolate:{r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},saddlebrown:{r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},sandybrown:{r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},peachpuff:{r:1,g:.8549019607843137,b:.7254901960784313},peru:{r:.803921568627451,g:.5215686274509804,b:.24705882352941178},linen:{r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},darkorange:{r:1,g:.5490196078431373,b:0},bisque:{r:1,g:.8941176470588236,b:.7686274509803922},burlywood:{r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},tan:{r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},antiquewhite:{r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},navajowhite:{r:1,g:.8705882352941177,b:.6784313725490196},blanchedalmond:{r:1,g:.9215686274509803,b:.803921568627451},papayawhip:{r:1,g:.9372549019607843,b:.8352941176470589},orange:{r:1,g:.6470588235294118,b:0},moccasin:{r:1,g:.8941176470588236,b:.7098039215686275},wheat:{r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},oldlace:{r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},floralwhite:{r:1,g:.9803921568627451,b:.9411764705882353},goldenrod:{r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},darkgoldenrod:{r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},cornsilk:{r:1,g:.9725490196078431,b:.8627450980392157},gold:{r:1,g:.8431372549019608,b:0},palegoldenrod:{r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},khaki:{r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},lemonchiffon:{r:1,g:.9803921568627451,b:.803921568627451},darkkhaki:{r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},beige:{r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},lightgoldenrodyellow:{r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},olive:{r:.5019607843137255,g:.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:.8784313725490196},ivory:{r:1,g:1,b:.9411764705882353},olivedrab:{r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},yellowgreen:{r:.6039215686274509,g:.803921568627451,b:.19607843137254902},darkolivegreen:{r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},greenyellow:{r:.6784313725490196,g:1,b:.1843137254901961},lawngreen:{r:.48627450980392156,g:.9882352941176471,b:0},chartreuse:{r:.4980392156862745,g:1,b:0},darkseagreen:{r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},forestgreen:{r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},limegreen:{r:.19607843137254902,g:.803921568627451,b:.19607843137254902},lightgreen:{r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},palegreen:{r:.596078431372549,g:.984313725490196,b:.596078431372549},darkgreen:{r:0,g:.39215686274509803,b:0},green:{r:0,g:.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:.9411764705882353,g:1,b:.9411764705882353},mediumseagreen:{r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},seagreen:{r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},springgreen:{r:0,g:1,b:.4980392156862745},mintcream:{r:.9607843137254902,g:1,b:.9803921568627451},mediumspringgreen:{r:0,g:.9803921568627451,b:.6039215686274509},mediumaquamarine:{r:.4,g:.803921568627451,b:.6666666666666666},aquamarine:{r:.4980392156862745,g:1,b:.8313725490196079},turquoise:{r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},lightseagreen:{r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},mediumturquoise:{r:.2823529411764706,g:.8196078431372549,b:.8},darkslategray:{r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},paleturquoise:{r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},teal:{r:0,g:.5019607843137255,b:.5019607843137255},darkcyan:{r:0,g:.5450980392156862,b:.5450980392156862},darkturquoise:{r:0,g:.807843137254902,b:.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:.8784313725490196,g:1,b:1},azure:{r:.9411764705882353,g:1,b:1},cadetblue:{r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},powderblue:{r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},lightblue:{r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},deepskyblue:{r:0,g:.7490196078431373,b:1},skyblue:{r:.5294117647058824,g:.807843137254902,b:.9215686274509803},lightskyblue:{r:.5294117647058824,g:.807843137254902,b:.9803921568627451},steelblue:{r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},aliceblue:{r:.9411764705882353,g:.9725490196078431,b:1},dodgerblue:{r:.11764705882352941,g:.5647058823529412,b:1},slategray:{r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},lightslategray:{r:.4666666666666667,g:.5333333333333333,b:.6},lightsteelblue:{r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},cornflowerblue:{r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},royalblue:{r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},midnightblue:{r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},lavender:{r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},navy:{r:0,g:0,b:.5019607843137255},darkblue:{r:0,g:0,b:.5450980392156862},mediumblue:{r:0,g:0,b:.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:.9725490196078431,g:.9725490196078431,b:1},darkslateblue:{r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},slateblue:{r:.41568627450980394,g:.35294117647058826,b:.803921568627451},mediumslateblue:{r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},mediumpurple:{r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},blueviolet:{r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},indigo:{r:.29411764705882354,g:0,b:.5098039215686274},darkorchid:{r:.6,g:.19607843137254902,b:.8},darkviolet:{r:.5803921568627451,g:0,b:.8274509803921568},mediumorchid:{r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},thistle:{r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},plum:{r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},violet:{r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},purple:{r:.5019607843137255,g:0,b:.5019607843137255},darkmagenta:{r:.5450980392156862,g:0,b:.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},mediumvioletred:{r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},deeppink:{r:1,g:.0784313725490196,b:.5764705882352941},hotpink:{r:1,g:.4117647058823529,b:.7058823529411765},palevioletred:{r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},lavenderblush:{r:1,g:.9411764705882353,b:.9607843137254902},crimson:{r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},pink:{r:1,g:.7529411764705882,b:.796078431372549},lightpink:{r:1,g:.7137254901960784,b:.7568627450980392}}};this.writers={"#HEX":function(e,t){return t._formatColor("#rxgxbx",e)},"#HEX3":function(t,n){var r=e.colorpicker.writers.HEX3(t);return r===false?false:"#"+r},HEX:function(e,t){return t._formatColor("rxgxbx",e)},HEX3:function(e,t){var n=e.getRGB(),r=Math.floor(n.r*255),i=Math.floor(n.g*255),s=Math.floor(n.b*255);if(r>>>4===(r&=15)&&i>>>4===(i&=15)&&s>>>4===(s&=15)){return r.toString(16)+i.toString(16)+s.toString(16)}return false},RGB:function(e,t){return e.getAlpha()>=1?t._formatColor("rgb(rd,gd,bd)",e):false},RGBA:function(e,t){return t._formatColor("rgba(rd,gd,bd,af)",e)},"RGB%":function(e,t){return e.getAlpha()>=1?t._formatColor("rgb(rp%,gp%,bp%)",e):false},"RGBA%":function(e,t){return t._formatColor("rgba(rp%,gp%,bp%,af)",e)},HSL:function(e,t){return e.getAlpha()>=1?t._formatColor("hsl(hd,sd,vd)",e):false},HSLA:function(e,t){return t._formatColor("hsla(hd,sd,vd,af)",e)},"HSL%":function(e,t){return e.getAlpha()>=1?t._formatColor("hsl(hp%,sp%,vp%)",e):false},"HSLA%":function(e,t){return t._formatColor("hsla(hp%,sp%,vp%,af)",e)},NAME:function(e,t){return t._closestName(e)},EXACT:function(e,t){return t._exactName(e)}};this.parsers={"":function(t){if(t===""){return new e.colorpicker.Color}},NAME:function(t,n){var r=n._getSwatch(e.trim(t));if(r){return new e.colorpicker.Color(r.r,r.g,r.b)}},RGBA:function(t){var n=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(t);if(n){return new e.colorpicker.Color(n[1]/255,n[2]/255,n[3]/255,parseFloat(n[4]))}},"RGBA%":function(t){var n=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(t);if(n){return new e.colorpicker.Color(n[1]/100,n[2]/100,n[3]/100,n[4]/100)}},HSLA:function(t){var n=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(t);if(n){return(new e.colorpicker.Color).setHSL(n[1]/255,n[2]/255,n[3]/255).setAlpha(parseFloat(n[4]))}},"HSLA%":function(t){var n=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(t);if(n){return(new e.colorpicker.Color).setHSL(n[1]/100,n[2]/100,n[3]/100).setAlpha(n[4]/100)}},"#HEX":function(t){var n=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(t);if(n){return new e.colorpicker.Color(parseInt(n[1],16)/255,parseInt(n[2],16)/255,parseInt(n[3],16)/255)}},"#HEX3":function(t){var n=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(t);if(n){return new e.colorpicker.Color(parseInt(String(n[1])+n[1],16)/255,parseInt(String(n[2])+n[2],16)/255,parseInt(String(n[3])+n[3],16)/255)}},HEX:function(t){var n=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(t);if(n){return new e.colorpicker.Color(parseInt(n[1],16)/255,parseInt(n[2],16)/255,parseInt(n[3],16)/255)}},HEX3:function(t){var n=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(t);if(n){return new e.colorpicker.Color(parseInt(String(n[1])+n[1],16)/255,parseInt(String(n[2])+n[2],16)/255,parseInt(String(n[3])+n[3],16)/255)}}};this.partslists={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]};this.limits={websafe:function(e){e.limit(6)},nibble:function(e){e.limit(16)},binary:function(e){e.limit(2)},name:function(e,t){var n=t._getSwatch(t._closestName(e));e.setRGB(n.r,n.g,n.b)}};this.parts={header:function(t){var n=this,r=null,i=function(){var e=t.options.title||t._getRegional("title"),n='<span class="ui-dialog-title">'+e+"</span>";if(!t.inline&&t.options.showCloseButton){n+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button">'+'<span class="ui-icon ui-icon-closethick">close</span></a>'}return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+n+"</div>"};this.init=function(){r=e(i()).prependTo(t.dialog);var n=e(".ui-dialog-titlebar-close",r);t._hoverable(n);t._focusable(n);n.click(function(e){e.preventDefault();t.close(t.options.revert)});if(!t.inline&&t.options.draggable){t.dialog.draggable({handle:r})}}},map:function(t){var n=this,r=null,i=null,s,o,u,a;s=function(n){if(!t.opened){return}var i=e(".ui-colorpicker-map-layer-pointer",r),a=i.offset(),f=i.width(),l=i.height(),c=n.pageX-a.left,h=n.pageY-a.top;if(c>=0&&c<f&&h>=0&&h<l){n.stopImmediatePropagation();n.preventDefault();r.unbind("mousedown",s);e(document).bind("mouseup",o);e(document).bind("mousemove",u);u(n)}};o=function(t){t.stopImmediatePropagation();t.preventDefault();e(document).unbind("mouseup",o);e(document).unbind("mousemove",u);r.bind("mousedown",s)};u=function(i){i.stopImmediatePropagation();i.preventDefault();if(i.pageX===n.x&&i.pageY===n.y){return}n.x=i.pageX;n.y=i.pageY;var s=e(".ui-colorpicker-map-layer-pointer",r),o=s.offset(),u=s.width(),a=s.height(),f=i.pageX-o.left,l=i.pageY-o.top;f=Math.max(0,Math.min(f/u,1));l=Math.max(0,Math.min(l/a,1));switch(t.mode){case"h":t.color.setHSV(null,f,1-l);break;case"s":case"a":t.color.setHSV(f,null,1-l);break;case"v":t.color.setHSV(f,1-l,null);break;case"r":t.color.setRGB(null,1-l,f);break;case"g":t.color.setRGB(1-l,null,f);break;case"b":t.color.setRGB(f,1-l,null);break}t._change()};a=function(){var e='<div class="ui-colorpicker-map ui-colorpicker-border">'+'<span class="ui-colorpicker-map-layer-1">&nbsp;</span>'+'<span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(t.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>';return e};this.update=function(){switch(t.mode){case"h":e(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 0",opacity:""}).show();e(".ui-colorpicker-map-layer-2",r).hide();break;case"s":case"a":e(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show();break;case"v":e(r).css("background-color","black");e(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -780px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",r).hide();break;case"r":e(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1040px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show();break;case"g":e(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1820px",opacity:""}).show();break;case"b":e(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -2080px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show();break}n.repaint()};this.repaint=function(){var n=e(".ui-colorpicker-map-layer-pointer",r),i=0,s=0;switch(t.mode){case"h":i=t.color.getHSV().s*n.width();s=(1-t.color.getHSV().v)*n.width();e(r).css("background-color",t.color.copy().setHSV(null,1,1).toCSS());break;case"s":case"a":i=t.color.getHSV().h*n.width();s=(1-t.color.getHSV().v)*n.width();e(".ui-colorpicker-map-layer-2",r).css("opacity",1-t.color.getHSV().s);break;case"v":i=t.color.getHSV().h*n.width();s=(1-t.color.getHSV().s)*n.width();e(".ui-colorpicker-map-layer-1",r).css("opacity",t.color.getHSV().v);break;case"r":i=t.color.getRGB().b*n.width();s=(1-t.color.getRGB().g)*n.width();e(".ui-colorpicker-map-layer-2",r).css("opacity",t.color.getRGB().r);break;case"g":i=t.color.getRGB().b*n.width();s=(1-t.color.getRGB().r)*n.width();e(".ui-colorpicker-map-layer-2",r).css("opacity",t.color.getRGB().g);break;case"b":i=t.color.getRGB().r*n.width();s=(1-t.color.getRGB().g)*n.width();e(".ui-colorpicker-map-layer-2",r).css("opacity",t.color.getRGB().b);break}if(t.options.alpha){e(".ui-colorpicker-map-layer-alpha",r).css("opacity",1-t.color.getAlpha())}e(".ui-colorpicker-map-pointer",r).css({left:i-7,top:s-7})};this.init=function(){r=e(a()).appendTo(e(".ui-colorpicker-map-container",t.dialog));r.bind("mousedown",s)}},bar:function(t){var n=this,r=null,i,s,o,u;i=function(n){if(!t.opened){return}var u=e(".ui-colorpicker-bar-layer-pointer",r),a=u.offset(),f=u.width(),l=u.height(),c=n.pageX-a.left,h=n.pageY-a.top;if(c>=0&&c<f&&h>=0&&h<l){n.stopImmediatePropagation();n.preventDefault();r.unbind("mousedown",i);e(document).bind("mouseup",s);e(document).bind("mousemove",o);o(n)}};s=function(t){t.stopImmediatePropagation();t.preventDefault();e(document).unbind("mouseup",s);e(document).unbind("mousemove",o);r.bind("mousedown",i)};o=function(i){i.stopImmediatePropagation();i.preventDefault();if(i.pageY===n.y){return}n.y=i.pageY;var s=e(".ui-colorpicker-bar-layer-pointer",r),o=s.offset(),u=s.height(),a=i.pageY-o.top;a=Math.max(0,Math.min(a/u,1));switch(t.mode){case"h":t.color.setHSV(1-a,null,null);break;case"s":t.color.setHSV(null,1-a,null);break;case"v":t.color.setHSV(null,null,1-a);break;case"r":t.color.setRGB(1-a,null,null);break;case"g":t.color.setRGB(null,1-a,null);break;case"b":t.color.setRGB(null,null,1-a);break;case"a":t.color.setAlpha(1-a);break}t._change()};u=function(){var e='<div class="ui-colorpicker-bar ui-colorpicker-border">'+'<span class="ui-colorpicker-bar-layer-1">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-2">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-3">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';if(t.options.alpha){e+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'}e+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>';return e};this.update=function(){switch(t.mode){case"h":case"s":case"v":case"r":case"g":case"b":e(".ui-colorpicker-bar-layer-alpha",r).show();e(".ui-colorpicker-bar-layer-alphabar",r).hide();break;case"a":e(".ui-colorpicker-bar-layer-alpha",r).hide();e(".ui-colorpicker-bar-layer-alphabar",r).show();break}switch(t.mode){case"h":e(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 0",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",r).hide();e(".ui-colorpicker-bar-layer-3",r).hide();e(".ui-colorpicker-bar-layer-4",r).hide();break;case"s":e(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",r).hide();e(".ui-colorpicker-bar-layer-4",r).hide();break;case"v":e(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -520px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",r).hide();e(".ui-colorpicker-bar-layer-3",r).hide();e(".ui-colorpicker-bar-layer-4",r).hide();break;case"r":e(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -780px",opacity:""}).show();e(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -1040px",opacity:""}).show();break;case"g":e(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -2600px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -1820px",opacity:""}).show();e(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -2080px",opacity:""}).show();break;case"b":e(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -3640px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -3380px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -2860px",opacity:""}).show();e(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -3120px",opacity:""}).show();break;case"a":e(".ui-colorpicker-bar-layer-1",r).hide();e(".ui-colorpicker-bar-layer-2",r).hide();e(".ui-colorpicker-bar-layer-3",r).hide();e(".ui-colorpicker-bar-layer-4",r).hide();break}n.repaint()};this.repaint=function(){var n=e(".ui-colorpicker-bar-layer-pointer",r),i=0;switch(t.mode){case"h":i=(1-t.color.getHSV().h)*n.height();break;case"s":i=(1-t.color.getHSV().s)*n.height();e(".ui-colorpicker-bar-layer-2",r).css("opacity",1-t.color.getHSV().v);e(r).css("background-color",t.color.copy().setHSV(null,1,null).toCSS());break;case"v":i=(1-t.color.getHSV().v)*n.height();e(r).css("background-color",t.color.copy().setHSV(null,null,1).toCSS());break;case"r":i=(1-t.color.getRGB().r)*n.height();e(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,t.color.getRGB().b-t.color.getRGB().g));e(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,t.color.getRGB().g-t.color.getRGB().b));e(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(t.color.getRGB().b,t.color.getRGB().g));break;case"g":i=(1-t.color.getRGB().g)*n.height();e(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,t.color.getRGB().b-t.color.getRGB().r));e(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,t.color.getRGB().r-t.color.getRGB().b));e(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(t.color.getRGB().r,t.color.getRGB().b));break;case"b":i=(1-t.color.getRGB().b)*n.height();e(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,t.color.getRGB().r-t.color.getRGB().g));e(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,t.color.getRGB().g-t.color.getRGB().r));e(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(t.color.getRGB().r,t.color.getRGB().g));break;case"a":i=(1-t.color.getAlpha())*n.height();e(r).css("background-color",t.color.copy().toCSS());break}if(t.mode!=="a"){e(".ui-colorpicker-bar-layer-alpha",r).css("opacity",1-t.color.getAlpha())}e(".ui-colorpicker-bar-pointer",r).css("top",i-3)};this.init=function(){r=e(u()).appendTo(e(".ui-colorpicker-bar-container",t.dialog));r.bind("mousedown",i)}},preview:function(t){var n=this,r=null,i;i=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border">'+'<div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div>'+'<div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div>'+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-preview-container",t.dialog));e(".ui-colorpicker-preview-initial",r).click(function(){t.color=t.currentColor.copy();t._change(t.color.set)})};this.update=function(){if(t.options.alpha){e(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",r).show()}else{e(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",r).hide()}this.repaint()};this.repaint=function(){e(".ui-colorpicker-preview-initial",r).css("background-color",t.currentColor.set?t.currentColor.toCSS():"").attr("title",t.currentColor.set?t.currentColor.toCSS():"");e(".ui-colorpicker-preview-initial-alpha",r).css("opacity",1-t.currentColor.getAlpha());e(".ui-colorpicker-preview-current",r).css("background-color",t.color.set?t.color.toCSS():"").attr("title",t.color.set?t.color.toCSS():"");e(".ui-colorpicker-preview-current-alpha",r).css("opacity",1-t.color.getAlpha())}},hsv:function(t){var n=this,r=null,i;i=function(){var e="";if(t.options.hsv){e+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+t._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div>'+'<div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+t._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+t._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-hsv">'+e+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-hsv-container",t.dialog));e(".ui-colorpicker-mode",r).click(function(){t.mode=e(this).val();t._updateAllParts()});e(".ui-colorpicker-number",r).bind("change keyup",function(){t.color.setHSV(e(".ui-colorpicker-hsv-h .ui-colorpicker-number",r).val()/360,e(".ui-colorpicker-hsv-s .ui-colorpicker-number",r).val()/100,e(".ui-colorpicker-hsv-v .ui-colorpicker-number",r).val()/100);t._change()})};this.repaint=function(){var n=t.color.getHSV();n.h*=360;n.s*=100;n.v*=100;e.each(n,function(t,n){var i=e(".ui-colorpicker-hsv-"+t+" .ui-colorpicker-number",r);n=Math.round(n);if(parseInt(i.val(),10)!==n){i.val(n)}})};this.update=function(){e(".ui-colorpicker-mode",r).each(function(){e(this).attr("checked",e(this).val()===t.mode)});this.repaint()}},rgb:function(t){var n=this,r=null,i;i=function(){var e="";if(t.options.rgb){e+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+t._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+t._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+t._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'}return'<div class="ui-colorpicker-rgb">'+e+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-rgb-container",t.dialog));e(".ui-colorpicker-mode",r).click(function(){t.mode=e(this).val();t._updateAllParts()});e(".ui-colorpicker-number",r).bind("change keyup",function(){var n=e(".ui-colorpicker-rgb-r .ui-colorpicker-number",r).val();t.color.setRGB(e(".ui-colorpicker-rgb-r .ui-colorpicker-number",r).val()/255,e(".ui-colorpicker-rgb-g .ui-colorpicker-number",r).val()/255,e(".ui-colorpicker-rgb-b .ui-colorpicker-number",r).val()/255);t._change()})};this.repaint=function(){e.each(t.color.getRGB(),function(t,n){var i=e(".ui-colorpicker-rgb-"+t+" .ui-colorpicker-number",r);n=Math.floor(n*255);if(parseInt(i.val(),10)!==n){i.val(n)}})};this.update=function(){e(".ui-colorpicker-mode",r).each(function(){e(this).attr("checked",e(this).val()===t.mode)});this.repaint()}},lab:function(t){var n=this,r=null,i=function(){var e="";if(t.options.hsv){e+='<div class="ui-colorpicker-lab-l"><label>'+t._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div>'+'<div class="ui-colorpicker-lab-a"><label>'+t._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'+'<div class="ui-colorpicker-lab-b"><label>'+t._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'}return'<div class="ui-colorpicker-lab">'+e+"</div>"};this.init=function(){var n=0;r=e(i()).appendTo(e(".ui-colorpicker-lab-container",t.dialog));e(".ui-colorpicker-number",r).bind("change keyup",function(n){t.color.setLAB(parseInt(e(".ui-colorpicker-lab-l .ui-colorpicker-number",r).val(),10)/100,(parseInt(e(".ui-colorpicker-lab-a .ui-colorpicker-number",r).val(),10)+128)/255,(parseInt(e(".ui-colorpicker-lab-b .ui-colorpicker-number",r).val(),10)+128)/255);t._change()})};this.repaint=function(){var n=t.color.getLAB();n.l*=100;n.a=n.a*255-128;n.b=n.b*255-128;e.each(n,function(t,n){var i=e(".ui-colorpicker-lab-"+t+" .ui-colorpicker-number",r);n=Math.round(n);if(parseInt(i.val(),10)!==n){i.val(n)}})};this.update=function(){this.repaint()}},cmyk:function(t){var n=this,r=null,i=function(){var e="";if(t.options.hsv){e+='<div class="ui-colorpicker-cmyk-c"><label>'+t._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-m"><label>'+t._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-y"><label>'+t._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-k"><label>'+t._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-cmyk">'+e+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-cmyk-container",t.dialog));e(".ui-colorpicker-number",r).bind("change keyup",function(n){t.color.setCMYK(parseInt(e(".ui-colorpicker-cmyk-c .ui-colorpicker-number",r).val(),10)/100,parseInt(e(".ui-colorpicker-cmyk-m .ui-colorpicker-number",r).val(),10)/100,parseInt(e(".ui-colorpicker-cmyk-y .ui-colorpicker-number",r).val(),10)/100,parseInt(e(".ui-colorpicker-cmyk-k .ui-colorpicker-number",r).val(),10)/100);t._change()})};this.repaint=function(){e.each(t.color.getCMYK(),function(t,n){var i=e(".ui-colorpicker-cmyk-"+t+" .ui-colorpicker-number",r);n=Math.round(n*100);if(parseInt(i.val(),10,10)!==n){i.val(n)}})};this.update=function(){this.repaint()}},alpha:function(t){var n=this,r=null,i;i=function(){var e="";if(t.options.alpha){e+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+t._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-alpha">'+e+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-alpha-container",t.dialog));e(".ui-colorpicker-mode",r).click(function(){t.mode=e(this).val();t._updateAllParts()});e(".ui-colorpicker-number",r).bind("change keyup",function(){t.color.setAlpha(e(".ui-colorpicker-a .ui-colorpicker-number",r).val()/100);t._change()})};this.update=function(){e(".ui-colorpicker-mode",r).each(function(){e(this).attr("checked",e(this).val()===t.mode)});this.repaint()};this.repaint=function(){var n=e(".ui-colorpicker-a .ui-colorpicker-number",r),i=Math.round(t.color.getAlpha()*100);if(parseInt(n.val(),10)!==i){n.val(i)}}},hex:function(t){var n=this,r=null,i;i=function(){var e="";if(t.options.alpha){e+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'}e+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>';return'<div class="ui-colorpicker-hex"><label>#</label>'+e+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-hex-container",t.dialog));e(".ui-colorpicker-hex-input",r).bind("change keydown keyup",function(t,n,r){if(/[^a-fA-F0-9]/.test(e(this).val())){e(this).val(e(this).val().replace(/[^a-fA-F0-9]/,""))}});e(".ui-colorpicker-hex-input",r).bind("change keyup",function(){t.color=o(e(this).val()).setAlpha(t.color.getAlpha());t._change()});e(".ui-colorpicker-hex-alpha",r).bind("change keydown keyup",function(){if(/[^a-fA-F0-9]/.test(e(this).val())){e(this).val(e(this).val().replace(/[^a-fA-F0-9]/,""))}});e(".ui-colorpicker-hex-alpha",r).bind("change keyup",function(){t.color.setAlpha(parseInt(e(".ui-colorpicker-hex-alpha",r).val(),16)/255);t._change()})};this.update=function(){this.repaint()};this.repaint=function(){if(!e(".ui-colorpicker-hex-input",r).is(":focus")){e(".ui-colorpicker-hex-input",r).val(t.color.toHex(true))}if(!e(".ui-colorpicker-hex-alpha",r).is(":focus")){e(".ui-colorpicker-hex-alpha",r).val(s(t.color.getAlpha()*255))}}},swatches:function(t){var n=this,r=null,i=function(){var n="";e.each(t._getSwatches(),function(t,r){var i=new e.colorpicker.Color(r.r,r.g,r.b),s=i.toCSS();n+='<div class="ui-colorpicker-swatch" style="background-color:'+s+'" title="'+t+'"></div>'});return'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+t.options.swatchesWidth+'px">'+n+"</div>"};this.init=function(){r=e(i()).appendTo(e(".ui-colorpicker-swatches-container",t.dialog));e(".ui-colorpicker-swatch",r).click(function(){t.color=t._parseColor(e(this).css("background-color"));t._change()})}},footer:function(n){var r=this,i=null,s="ui-colorpicker-special-transparent-"+t,o="ui-colorpicker-special-none-"+t,u=function(){var e="";if(n.options.alpha||!n.inline&&n.options.showNoneButton){e+='<div class="ui-colorpicker-buttonset">';if(n.options.alpha){e+='<input type="radio" name="ui-colorpicker-special" id="'+s+'" class="ui-colorpicker-special-transparent"/><label for="'+s+'">'+n._getRegional("transparent")+"</label>"}if(!n.inline&&n.options.showNoneButton){e+='<input type="radio" name="ui-colorpicker-special" id="'+o+'" class="ui-colorpicker-special-none"><label for="'+o+'">'+n._getRegional("none")+"</label>"}e+="</div>"}if(!n.inline){e+='<div class="ui-dialog-buttonset">';if(n.options.showCancelButton){e+='<button class="ui-colorpicker-cancel">'+n._getRegional("cancel")+"</button>"}e+='<button class="ui-colorpicker-ok">'+n._getRegional("ok")+"</button>";e+="</div>"}return'<div class="ui-dialog-buttonpane ui-widget-content">'+e+"</div>"};this.init=function(){i=e(u()).appendTo(n.dialog);e(".ui-colorpicker-ok",i).button().click(function(){n.close()});e(".ui-colorpicker-cancel",i).button().click(function(){n.close(true)});e(".ui-colorpicker-buttonset",i).buttonset();e(".ui-colorpicker-special-color",i).click(function(){n._change()});e("#"+o,i).click(function(){n._change(false)});e("#"+s,i).click(function(){n.color.setAlpha(0);n._change()})};this.repaint=function(){if(!n.color.set){e(".ui-colorpicker-special-none",i).attr("checked",true).button("refresh")}else if(n.color.getAlpha()===0){e(".ui-colorpicker-special-transparent",i).attr("checked",true).button("refresh")}else{e("input",i).attr("checked",false).button("refresh")}e(".ui-colorpicker-cancel",i).button(n.changed?"enable":"disable")};this.update=function(){}}};this.Color=function(){var t={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},n=1,r=[.9504285,1,1.0889],i=arguments,s=function(e){if(isNaN(e)||e===null){return 0}if(typeof e=="string"){e=parseInt(e,10)}return Math.max(0,Math.min(e,1))},o=function(e){var t="0123456789abcdef",n=e%16,r=(e-n)/16,i=t.charAt(r)+t.charAt(n);return i},u=function(e){var t=e.r>.04045?Math.pow((e.r+.055)/1.055,2.4):e.r/12.92,n=e.g>.04045?Math.pow((e.g+.055)/1.055,2.4):e.g/12.92,r=e.b>.04045?Math.pow((e.b+.055)/1.055,2.4):e.b/12.92;return{x:t*.4124+n*.3576+r*.1805,y:t*.2126+n*.7152+r*.0722,z:t*.0193+n*.1192+r*.9505}},a=function(e){var t={r:e.x*3.2406+e.y*-1.5372+e.z*-.4986,g:e.x*-.9689+e.y*1.8758+e.z*.0415,b:e.x*.0557+e.y*-.204+e.z*1.057};t.r=t.r>.0031308?1.055*Math.pow(t.r,1/2.4)-.055:12.92*t.r;t.g=t.g>.0031308?1.055*Math.pow(t.g,1/2.4)-.055:12.92*t.g;t.b=t.b>.0031308?1.055*Math.pow(t.b,1/2.4)-.055:12.92*t.b;return t},f=function(e){var t=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),r=n-t,i,s,o,u={h:0,s:0,v:n};if(r===0){u.h=0;u.s=0}else{u.s=r/n;i=((n-e.r)/6+r/2)/r;s=((n-e.g)/6+r/2)/r;o=((n-e.b)/6+r/2)/r;if(e.r===n){u.h=o-s}else if(e.g===n){u.h=1/3+i-o}else if(e.b===n){u.h=2/3+s-i}if(u.h<0){u.h+=1}else if(u.h>1){u.h-=1}}return u},l=function(e){var t={r:0,g:0,b:0},n,r,i,s,o;if(e.s===0){t.r=t.g=t.b=e.v}else{n=e.h===1?0:e.h*6;r=Math.floor(n);i=e.v*(1-e.s);s=e.v*(1-e.s*(n-r));o=e.v*(1-e.s*(1-(n-r)));if(r===0){t.r=e.v;t.g=o;t.b=i}else if(r===1){t.r=s;t.g=e.v;t.b=i}else if(r===2){t.r=i;t.g=e.v;t.b=o}else if(r===3){t.r=i;t.g=s;t.b=e.v}else if(r===4){t.r=o;t.g=i;t.b=e.v}else{t.r=e.v;t.g=i;t.b=s}}return t},c=function(e){var t=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),r=n-t,i,s,o,u={h:0,s:0,l:(n+t)/2};if(r===0){u.h=0;u.s=0}else{u.s=u.l<.5?r/(n+t):r/(2-n-t);i=((n-e.r)/6+r/2)/r;s=((n-e.g)/6+r/2)/r;o=((n-e.b)/6+r/2)/r;if(e.r===n){u.h=o-s}else if(e.g===n){u.h=1/3+i-o}else if(e.b===n){u.h=2/3+s-i}if(u.h<0){u.h+=1}else if(u.h>1){u.h-=1}}return u},h=function(e){var t,n,r=function(e,t,n){if(n<0){n+=1}if(n>1){n-=1}if(6*n<1){return e+(t-e)*6*n}if(2*n<1){return t}if(3*n<2){return e+(t-e)*(2/3-n)*6}return e};if(e.s===0){return{r:e.l,g:e.l,b:e.l}}n=e.l<.5?e.l*(1+e.s):e.l+e.s-e.s*e.l;t=2*e.l-n;return{r:r(t,n,e.h+1/3),g:r(t,n,e.h),b:r(t,n,e.h-1/3)}},p=function(e){var t=e.x/r[0],n=e.y/r[1],i=e.z/r[2];t=t>.008856?Math.pow(t,1/3):7.787*t+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;return{l:(116*n-16)/100,a:(500*(t-n)+128)/255,b:(200*(n-i)+128)/255}},d=function(e){var t={l:e.l*100,a:e.a*255-128,b:e.b*255-128},n={x:0,y:(t.l+16)/116,z:0};n.x=t.a/500+n.y;n.z=n.y-t.b/200;n.x=Math.pow(n.x,3)>.008856?Math.pow(n.x,3):(n.x-16/116)/7.787;n.y=Math.pow(n.y,3)>.008856?Math.pow(n.y,3):(n.y-16/116)/7.787;n.z=Math.pow(n.z,3)>.008856?Math.pow(n.z,3):(n.z-16/116)/7.787;n.x*=r[0];n.y*=r[1];n.z*=r[2];return n},v=function(e){return{c:1-e.r,m:1-e.g,y:1-e.b}},m=function(e){return{r:1-e.c,g:1-e.m,b:1-e.y}},g=function(e){var t=1;if(e.c<t){t=e.c}if(e.m<t){t=e.m}if(e.y<t){t=e.y}if(t===1){return{c:0,m:0,y:0,k:1}}return{c:(e.c-t)/(1-t),m:(e.m-t)/(1-t),y:(e.y-t)/(1-t),k:t}},y=function(e){return{c:e.c*(1-e.k)+e.k,m:e.m*(1-e.k)+e.k,y:e.y*(1-e.k)+e.k}};this.set=false;this.setAlpha=function(e){if(e!==null){n=s(e)}return this};this.getAlpha=function(){return n};this.setRGB=function(e,n,r){t={rgb:this.getRGB()};if(e!==null){t.rgb.r=s(e)}if(n!==null){t.rgb.g=s(n)}if(r!==null){t.rgb.b=s(r)}return this};this.setHSV=function(e,n,r){t={hsv:this.getHSV()};if(e!==null){t.hsv.h=s(e)}if(n!==null){t.hsv.s=s(n)}if(r!==null){t.hsv.v=s(r)}return this};this.setHSL=function(e,n,r){t={hsl:this.getHSL()};if(e!==null){t.hsl.h=s(e)}if(n!==null){t.hsl.s=s(n)}if(r!==null){t.hsl.l=s(r)}return this};this.setLAB=function(e,n,r){t={lab:this.getLAB()};if(e!==null){t.lab.l=s(e)}if(n!==null){t.lab.a=s(n)}if(r!==null){t.lab.b=s(r)}return this};this.setCMYK=function(e,n,r,i){t={cmyk:this.getCMYK()};if(e!==null){t.cmyk.c=s(e)}if(n!==null){t.cmyk.m=s(n)}if(r!==null){t.cmyk.y=s(r)}if(i!==null){t.cmyk.k=s(i)}return this};this.getRGB=function(){if(!t.rgb){t.rgb=t.lab?a(d(t.lab)):t.hsv?l(t.hsv):t.hsl?h(t.hsl):t.cmyk?m(y(t.cmyk)):{r:0,g:0,b:0};t.rgb.r=s(t.rgb.r);t.rgb.g=s(t.rgb.g);t.rgb.b=s(t.rgb.b)}return e.extend({},t.rgb)};this.getHSV=function(){if(!t.hsv){t.hsv=t.lab?f(this.getRGB()):t.rgb?f(t.rgb):t.hsl?f(this.getRGB()):t.cmyk?f(this.getRGB()):{h:0,s:0,v:0};t.hsv.h=s(t.hsv.h);t.hsv.s=s(t.hsv.s);t.hsv.v=s(t.hsv.v)}return e.extend({},t.hsv)};this.getHSL=function(){if(!t.hsl){t.hsl=t.rgb?c(t.rgb):t.hsv?c(this.getRGB()):t.cmyk?c(this.getRGB()):t.hsv?c(this.getRGB()):{h:0,s:0,l:0};t.hsl.h=s(t.hsl.h);t.hsl.s=s(t.hsl.s);t.hsl.l=s(t.hsl.l)}return e.extend({},t.hsl)};this.getCMYK=function(){if(!t.cmyk){t.cmyk=t.rgb?g(v(t.rgb)):t.hsv?g(v(this.getRGB())):t.hsl?g(v(this.getRGB())):t.lab?g(v(this.getRGB())):{c:0,m:0,y:0,k:1};t.cmyk.c=s(t.cmyk.c);t.cmyk.m=s(t.cmyk.m);t.cmyk.y=s(t.cmyk.y);t.cmyk.k=s(t.cmyk.k)}return e.extend({},t.cmyk)};this.getLAB=function(){if(!t.lab){t.lab=t.rgb?p(u(t.rgb)):t.hsv?p(u(this.getRGB())):t.hsl?p(u(this.getRGB())):t.cmyk?p(u(this.getRGB())):{l:0,a:0,b:0};t.lab.l=s(t.lab.l);t.lab.a=s(t.lab.a);t.lab.b=s(t.lab.b)}return e.extend({},t.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}};this.getSpaces=function(){return e.extend(true,{},t)};this.setSpaces=function(e){t=e;return this};this.distance=function(e){var t="lab",n="get"+t.toUpperCase(),r=this[n](),i=e[n](),s=0,o;for(o in r){s+=Math.pow(r[o]-i[o],2)}return s};this.equals=function(e){var t=this.getRGB(),n=e.getRGB();return this.getAlpha()===e.getAlpha()&&t.r===n.r&&t.g===n.g&&t.b===n.b};this.limit=function(e){e-=1;var t=this.getRGB();this.setRGB(Math.round(t.r*e)/e,Math.round(t.g*e)/e,Math.round(t.b*e)/e)};this.toHex=function(){var e=this.getRGB();return o(e.r*255)+o(e.g*255)+o(e.b*255)};this.toCSS=function(){return"#"+this.toHex()};this.copy=function(){var t=new e.colorpicker.Color(this.getSpaces(),this.getAlpha());t.set=this.set;return t};if(i.length===2){this.setSpaces(i[0]);this.setAlpha(i[1]===0?0:i[1]||1);this.set=true}if(i.length>2){this.setRGB(i[0],i[1],i[2]);this.setAlpha(i[3]===0?0:i[3]||1);this.set=true}}};e.widget("vanderlee.colorpicker",{options:{alpha:false,altAlpha:true,altField:"",altOnChange:true,altProperties:"background-color",autoOpen:false,buttonClass:null,buttonColorize:false,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:false,buttonText:null,closeOnEscape:true,closeOnOutside:true,color:"#00FF00",colorFormat:"HEX",draggable:true,duration:"fast",hsv:true,inline:true,inlineFrame:true,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:false,mode:"h",okOnEnter:false,parts:"",regional:"",revert:false,rgb:true,showAnim:"fadeIn",showCancelButton:true,showNoneButton:false,showCloseButton:true,showOn:"focus click alt",showOptions:{},swatches:null,swatchesWidth:84,title:null,cancel:null,close:null,init:null,select:null,ok:null,open:null},_create:function(){var n=this,r;++t;n.widgetEventPrefix="colorpicker";n.opened=false;n.generated=false;n.inline=false;n.changed=false;n.dialog=null;n.button=null;n.image=null;n.overlay=null;n.mode=n.options.mode;if(n.element.is("input")||n.options.inline===false){n._setColor(n.element.is("input")?n.element.val():n.options.color);n._callback("init");if(/\bfocus|both\b/.test(n.options.showOn)){n.element.bind("focus",function(){n.open()})}if(/\bclick|both\b/.test(n.options.showOn)){n.element.bind("click",function(){n.open()})}if(/\bbutton|both\b/.test(n.options.showOn)){if(n.options.buttonImage!==""){r=n.options.buttonText||n._getRegional("button");n.image=e("<img/>").attr({src:n.options.buttonImage,alt:r,title:r});if(n.options.buttonClass){n.image.attr("class",n.options.buttonClass)}n._setImageBackground()}if(n.options.buttonImageOnly&&n.image){n.button=n.image}else{n.button=e('<button type="button"></button>').html(n.image||n.options.buttonText).button();n.image=n.image?e("img",n.button).first():null}n.button.insertAfter(n.element).click(function(){n[n.opened?"close":"open"]()})}if(/\balt|both\b/.test(n.options.showOn)){e(n.options.altField).bind("click",function(){n.open()})}if(n.options.autoOpen){n.open()}}else{n.inline=true;n._generate();n.opened=true}return this},_setOption:function(t,n){var r=this;switch(t){case"disabled":if(n){r.dialog.addClass("ui-colorpicker-disabled")}else{r.dialog.removeClass("ui-colorpicker-disabled")}break}e.Widget.prototype._setOption.apply(r,arguments)},_setImageBackground:function(){if(this.image&&this.options.buttonColorize){this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")}},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var t,n,r=this.options.altProperties.split(",");for(t=0;t<=r.length;++t){n=e.trim(r[t]);switch(n){case"color":case"background-color":case"backgroundColor":case"outline-color":case"border-color":e(this.options.altField).css(n,this.color.set?this.color.toCSS():"");break}}if(this.options.altAlpha){e(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}}},_setColor:function(e){this.color=this._parseColor(e);this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(e){this._setColor(e);this._change(this.color.set)},_generateInline:function(){var t=this;e(t.element).html(t.options.inlineFrame?r:i);t.dialog=e(".ui-colorpicker",t.element)},_generatePopup:function(){var t=this;e("body").append(n);t.dialog=e(".ui-colorpicker:last");e(document).delegate("html","touchstart click",function(n){if(!t.opened||n.target===t.element[0]||t.overlay){return}if(t.dialog.is(n.target)||t.dialog.has(n.target).length>0){t.element.blur();return}var r,i=e(n.target).parents();i.push(n.target);for(r=0;r<=i.length;++r){if(t.button!==null&&i[r]===t.button[0]){return}if(/\balt|both\b/.test(t.options.showOn)&&e(t.options.altField).is(i[r])){return}}if(!t.options.closeOnOutside){return}t.close(t.options.revert)});e(document).keydown(function(e){if(t.opened&&e.keyCode===27&&t.options.closeOnEscape){t.close(t.options.revert)}if(t.opened&&e.keyCode===13&&t.options.okOnEnter){t.close()}});t.element.keydown(function(e){if(e.keyCode===9){t.close()}}).keyup(function(e){var n=t._parseColor(t.element.val());if(!t.color.equals(n)){t.color=n;t._change()}})},_generate:function(){var t=this,n,r,i,s,o,a;t._setColor(t.inline||!t.element.is("input")?t.options.color:t.element.val());t[t.inline?"_generateInline":"_generatePopup"]();if(typeof t.options.parts==="string"){if(e.colorpicker.partslists[t.options.parts]){i=e.colorpicker.partslists[t.options.parts]}else{i=e.colorpicker.partslists[t.inline?"inline":"popup"]}}else{i=t.options.parts}t.parts={};e.each(i,function(n,r){if(e.colorpicker.parts[r]){t.parts[r]=new e.colorpicker.parts[r](t)}});if(!t.generated){s=[];e.each(t.options.layout,function(e,n){if(t.parts[e]){s.push({part:e,pos:n})}});o=e(u(s,function(e,t,n){a=["ui-colorpicker-"+e.part+"-container"];if(t>0){a.push("ui-colorpicker-padding-left")}if(n>0){a.push("ui-colorpicker-padding-top")}return'<td  class="'+a.join(" ")+'"'+(e.pos[2]>1?' colspan="'+e.pos[2]+'"':"")+(e.pos[3]>1?' rowspan="'+e.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(t.dialog);if(t.options.inlineFrame){o.addClass("ui-dialog-content ui-widget-content")}t._initAllParts();t._updateAllParts();t.generated=true}},_effectGeneric:function(t,n,r,i,s){var o=this;if(e.effects&&e.effects[o.options.showAnim]){t[n](o.options.showAnim,o.options.showOptions,o.options.duration,s)}else{t[o.options.showAnim==="slideDown"?r:o.options.showAnim==="fadeIn"?i:n](o.options.showAnim?o.options.duration:null,s);if(!o.options.showAnim||!o.options.duration){s()}}},_effectShow:function(e,t){this._effectGeneric(e,"show","slideDown","fadeIn",t)},_effectHide:function(e,t){this._effectGeneric(e,"hide","slideUp","fadeOut",t)},open:function(){var t=this,n,r,i,s,o,u,a,f,l;if(!t.opened){t._generate();if(t.element.is(":hidden")){l=e("<div/>").insertBefore(t.element);n=l.offset();l.remove()}else{n=t.element.offset()}r=e(window).height()+e(window).scrollTop();i=e(window).width()+e(window).scrollLeft();s=t.dialog.outerHeight(false);o=t.dialog.outerWidth();u=n.left;a=n.top+t.element.outerHeight(false);if(u+o>i){u=Math.max(0,i-o)}if(a+s>r){if(n.top-s>=e(window).scrollTop()){a=n.top-s}else{a=Math.max(0,r-s)}}t.dialog.css({left:u,top:a});f=0;e(t.element[0]).parents().each(function(){var t=e(this).css("z-index");if((typeof t==="number"||typeof t==="string")&&t!==""&&!isNaN(t)){if(t>f){f=parseInt(t,10);return false}}else{e(this).siblings().each(function(){var t=e(this).css("z-index");if((typeof t==="number"||typeof t==="string")&&t!==""&&!isNaN(t)){if(t>f){f=parseInt(t,10)}}})}});t.dialog.css("z-index",f+=2);t.overlay=t.options.modal?new e.ui.dialog.overlay(t):null;if(t.overlay!==null){var c=t.overlay.$el.css("z-index");if((typeof c==="number"||typeof c==="string")&&c!==""&&!isNaN(c)){t.dialog.css("z-index",f+c+2)}}t._effectShow(this.dialog);t.opened=true;t._callback("open",true);e(function(){t._repaintAllParts()})}},close:function(e){var t=this;if(e){t.color=t.currentColor.copy();t._change(t.color.set);t._callback("cancel",true)}else{t.currentColor=t.color.copy();t._callback("ok",true)}t.changed=false;t._effectHide(t.dialog,function(){t.dialog.remove();t.dialog=null;t.generated=false;t.opened=false;t._callback("close",true)});if(t.overlay){t.overlay.destroy()}},destroy:function(){this.element.unbind();if(this.image!==null){this.image.remove()}if(this.button!==null){this.button.remove()}if(this.dialog!==null){this.dialog.remove()}if(this.overlay){this.overlay.destroy()}},_callback:function(e,t){var n=this,r,i;if(n.color.set){r={formatted:n._formatColor(n.options.colorFormat,n.color),colorPicker:n};i=n.color.getLAB();i.a=i.a*2-1;i.b=i.b*2-1;if(t===true){r.a=n.color.getAlpha();r.rgb=n.color.getRGB();r.hsv=n.color.getHSV();r.cmyk=n.color.getCMYK();r.hsl=n.color.getHSL();r.lab=i}return n._trigger(e,null,r)}else{return n._trigger(e,null,{formatted:"",colorPicker:n})}},_initAllParts:function(){e.each(this.parts,function(e,t){if(t.init){t.init()}})},_updateAllParts:function(){e.each(this.parts,function(e,t){if(t.update){t.update()}})},_repaintAllParts:function(){e.each(this.parts,function(e,t){if(t.repaint){t.repaint()}})},_change:function(t){this.color.set=t!==false;this.changed=true;if(this.options.limit&&e.colorpicker.limits[this.options.limit]){e.colorpicker.limits[this.options.limit](this.color,this)}if(!this.inline){if(!this.color.set){this.element.val("")}else if(!this.color.equals(this._parseColor(this.element.val()))){this.element.val(this._formatColor(this.options.colorFormat,this.color))}this._setImageBackground();this._setAltField()}this.options.color=this.color.set?this.color.toCSS():"";if(this.opened){this._repaintAllParts()}this._callback("select")},_hoverable:function(e){e.hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")})},_focusable:function(e){e.focus(function(){e.addClass("ui-state-focus")}).blur(function(){e.removeClass("ui-state-focus")})},_getRegional:function(t){return e.colorpicker.regional[this.options.regional][t]!==undefined?e.colorpicker.regional[this.options.regional][t]:e.colorpicker.regional[""][t]},_getSwatches:function(){if(typeof this.options.swatches==="string"){return e.colorpicker.swatches[this.options.swatches]}if(e.isPlainObject(this.options.swatches)){return e.colorpicker.swatches}return e.colorpicker.swatches.html},_getSwatch:function(t){var n=this._getSwatches(),r=false;if(n[t]!==undefined){return n[t]}e.each(n,function(e,n){if(e.toLowerCase()==t.toLowerCase()){r=n;return false}return true});return r},_parseColor:function(t){var n=this,r;e.each(e.colorpicker.parsers,function(e,i){r=i(t,n);if(r){return false}});if(r){return r}return new e.colorpicker.Color},_exactName:function(t){var n=false;e.each(this._getSwatches(),function(r,i){if(t.equals(new e.colorpicker.Color(i.r,i.g,i.b))){n=r;return false}return true});return n},_closestName:function(t){var n=t.getRGB(),r=null,i=false,s;e.each(this._getSwatches(),function(n,o){s=t.distance(new e.colorpicker.Color(o.r,o.g,o.b));if(s<r||r===null){i=n;if(s===0){return false}r=s}return true});return i},_formatColor:function(t,n){var r=this,i=null,o={x:function(e){return s(e*255)},d:function(e){return Math.floor(e*255)},f:function(e){return e},p:function(e){return e*100}},u=n.getChannels();if(!e.isArray(t)){t=[t]}e.each(t,function(t,s){if(e.colorpicker.writers[s]){i=e.colorpicker.writers[s](n,r);return i===false}else{i=s.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(e){if(e.match(/^\\/)){return e.slice(1)}return o[e.charAt(1)](u[e.charAt(0)])});return false}});return i}})})(jQuery)